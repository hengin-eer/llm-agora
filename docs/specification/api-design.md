# API設計

## 1. エンドポイント一覧

### 1.1. 議論の進行
- **POST `/api/chat`**
  - **概要**: ユーザーのメッセージを受け取り、LLMのレスポンスを生成。また、`stop` パラメータを使用して議論を終了可能。
  - **リクエスト**:
    ```json
    {
      "message": "ユーザーのメッセージ",
      "context": ["過去のメッセージ1", "過去のメッセージ2"],
      "role": "ユーザー",
      "stop": false
    }
    ```
    - `stop`: `true` の場合、議論を終了し、レスポンスとして終了メッセージを返す。
  - **レスポンス**:
    - 通常のレスポンス:
      ```json
      {
        "role": "LLM",
        "message": "LLMの生成したメッセージ"
      }
      ```
    - `stop: true` の場合:
      ```json
      {
        "status": "stopped",
        "message": "議論が終了しました"
      }
      ```

---

### 1.2. 議題の設定
- **POST `/api/topic`**
  - **概要**: 議題を設定し、LLM同士の議論を開始。
  - **リクエスト**:
    ```json
    {
      "topic": "議論のテーマ"
    }
    ```
  - **レスポンス**:
    ```json
    {
      "status": "success",
      "message": "議論が開始されました"
    }
    ```

---

### 1.3. メタLLMへの質問
- **POST `/api/meta`**
  - **概要**: メタLLMに質問を送信し、回答を取得。
  - **リクエスト**:
    ```json
    {
      "question": "メタLLMへの質問内容"
    }
    ```
  - **レスポンス**:
    ```json
    {
      "role": "メタLLM",
      "message": "メタLLMの回答"
    }
    ```

---

## 2. API設計のポイント

1. **エンドポイントの統一**:
   - `/api/chat` に `stop` パラメータを組み込むことで、議論の進行と終了を1つのエンドポイントで管理。
   - エンドポイントの数を減らし、コードの管理を簡素化。

2. **ステートレス設計**:
   - 各リクエストは必要なデータ（メッセージ履歴や議題）を含むことで、サーバー側での状態管理を最小限に抑える。

3. **エラーハンドリング**:
   - 各エンドポイントでエラーが発生した場合、以下の形式でエラーレスポンスを返す。
     ```json
     {
       "status": "error",
       "message": "エラー内容"
     }
     ```

4. **認証とセキュリティ**:
   - 必要に応じて、APIキーやトークンを使用して認証を実装。

5. **拡張性**:
   - 将来的に新しいパラメータや機能を追加しやすい設計。
